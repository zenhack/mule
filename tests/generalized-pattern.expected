
Desugared:

	(letrec (types ())
	 (values
	  ((x (: $6 (all a (a -> a))))
	   ($6 ((match ((Ok ($7 $7)))) ((fn x (Ok x)) (fn x x))))))
	 (letrec (types ()) (values ((k (x {})) (v (x (fn y y)))))
	  (.= k k (.= v v {}))))

inferred type:

	(record (types ())
	 (values ((k (record (types ()) (values ()))) (v (all a (a -> a))))))

Runtime term:

	(LetRec
	 (((2 (Var 1))
	   (0
	    (App
	     ((Match
	       (BLabel (lm_cases ((Ok (BLeaf (Lam (0 () (Var 0)))))))
	        (lm_default ())))
	      (App ((Lam (0 () (Ctor (Ok (Var 0))))) (Lam (0 () (Var 0)))))))))
	  (LetRec
	   (((3 (App ((Var 2) (Record ()))))
	     (3 (App ((Var 2) (Lam (0 () (Var 0)))))))
	    (Update (old (Update (old (Record ())) (label v) (field (Var 1))))
	     (label k) (field (Var 0)))))))

Evaluated:

	(Record ((k (Record ())) (v (Lam (0 () (Var 0))))))
