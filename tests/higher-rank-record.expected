
Desugared:

	(letrec (types ())
	 (values ((r (letrec (types ()) (values ((y (fn x x)))) (((.= y) {}) y)))))
	 (letrec (types ()) (values ((f (: ((. y) r) (all a (a -> a))))))
	  (letrec (types ()) (values ((l (f {})) (k (f (fn z z)))))
	   (((.= l) (((.= k) {}) k)) l))))

inferred type:

	(record (types ())
	 (values ((l (record (types ()) (values ()))) (k (all a (a -> a))))))

Runtime term:

	(LetRec
	 (((0
	    (LetRec
	     (((0 (Lam (0 () (Var 0)))))
	      (App
	       ((App
	         ((Lam
	           (0 ()
	            (Lam (1 () (Update (old (Var 1)) (label y) (field (Var 0)))))))
	          (Record ())))
	        (Var 0)))))))
	  (LetRec
	   (((2 (App ((GetField y) (Var 1)))))
	    (LetRec
	     (((3 (App ((Var 2) (Record ()))))
	       (3 (App ((Var 2) (Lam (0 () (Var 0)))))))
	      (App
	       ((App
	         ((Lam
	           (0 ()
	            (Lam (1 () (Update (old (Var 1)) (label l) (field (Var 0)))))))
	          (App
	           ((App
	             ((Lam
	               (0 ()
	                (Lam (1 () (Update (old (Var 1)) (label k) (field (Var 0)))))))
	              (Record ())))
	            (Var 1)))))
	        (Var 0)))))))))

Evaluated:

	(Record ((k (Lam (0 () (Var 0)))) (l (Record ()))))
