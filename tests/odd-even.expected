
Desugared:

	(((. odd)
	  (letrec (types ())
	   (values
	    ((even
	      ((:
	        ((rec n (union ((Z (record (types ()) (values ()))) (S n)))) ->
	         (union
	          ((True (record (types ()) (values ())))
	           (False (record (types ()) (values ())))))))
	       (fn x
	        ((match
	          ((S ($2 ((match () (k (odd k))) $2)))
	           (Z ($3 ((match () (_ ((fn x (True x)) {}))) $3)))))
	         x))))
	     (odd
	      ((:
	        ((rec n (union ((Z (record (types ()) (values ()))) (S n)))) ->
	         (union
	          ((True (record (types ()) (values ())))
	           (False (record (types ()) (values ())))))))
	       (fn x
	        ((match
	          ((S ($0 ((match () (k (even k))) $0)))
	           (Z ($1 ((match () (_ ((fn x (False x)) {}))) $1)))))
	         x))))))
	   (((.= even) (((.= odd) {}) odd)) even)))
	 ((fn x (S x))
	  ((fn x (S x)) ((fn x (S x)) ((fn x (S x)) ((fn x (Z x)) {}))))))

inferred type:

	(union
	 ((False (record (types ()) (values ())))
	  (True (record (types ()) (values ())))))

Runtime term:

	(App
	 ((App
	   ((GetField odd)
	    (LetRec
	     (((2
	        (Lam
	         (2 ()
	          (App
	           ((Match
	             (cases
	              ((S
	                (Lam
	                 (3 ()
	                  (App
	                   ((Match (cases ())
	                     (default ((Lam (4 () (App ((Var 4) (Var 0))))))))
	                    (Var 0))))))
	               (Z
	                (Lam
	                 (0 ()
	                  (App
	                   ((Match (cases ())
	                     (default
	                      ((Lam
	                        (0 ()
	                         (App
	                          ((Lam (0 () (Ctor (True (Var 0))))) (Record ()))))))))
	                    (Var 0))))))))
	             (default ()))
	            (Var 0))))))
	       (1
	        (Lam
	         (1 ()
	          (App
	           ((Match
	             (cases
	              ((S
	                (Lam
	                 (2 ()
	                  (App
	                   ((Match (cases ())
	                     (default ((Lam (3 () (App ((Var 3) (Var 0))))))))
	                    (Var 0))))))
	               (Z
	                (Lam
	                 (0 ()
	                  (App
	                   ((Match (cases ())
	                     (default
	                      ((Lam
	                        (0 ()
	                         (App
	                          ((Lam (0 () (Ctor (False (Var 0))))) (Record ()))))))))
	                    (Var 0))))))))
	             (default ()))
	            (Var 0)))))))
	      (App
	       ((App
	         ((Lam
	           (0 ()
	            (Lam (1 () (Update (old (Var 1)) (label even) (field (Var 0)))))))
	          (App
	           ((App
	             ((Lam
	               (0 ()
	                (Lam
	                 (1 () (Update (old (Var 1)) (label odd) (field (Var 0)))))))
	              (Record ())))
	            (Var 1)))))
	        (Var 0)))))))
	  (App
	   ((Lam (0 () (Ctor (S (Var 0)))))
	    (App
	     ((Lam (0 () (Ctor (S (Var 0)))))
	      (App
	       ((Lam (0 () (Ctor (S (Var 0)))))
	        (App
	         ((Lam (0 () (Ctor (S (Var 0)))))
	          (App ((Lam (0 () (Ctor (Z (Var 0))))) (Record ())))))))))))))

Evaluated:

	(Ctor (False (Record ())))
