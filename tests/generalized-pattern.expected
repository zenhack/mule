
Desugared:

	(letrec (types ())
	 (values
	  ((x ((: (all a (a -> a))) $0))
	   ($0
	    ((match ((Ok ($2 ((match () ($1 $1)) $2))))) ((fn x (Ok x)) (fn x x))))))
	 (letrec (types ()) (values ((k (x {})) (v (x (fn y y)))))
	  (((.= k) (((.= v) {}) v)) k)))

inferred type:

	(all a
	 (all b
	  (all c
	   (record (types (...c))
	    (values ((k (record (types (...a)) (values ()))) (v (b -> b))))))))

Runtime term:

	(LetRec
	 (((2 (Var 1))
	   (0
	    (App
	     ((Match
	       (cases
	        ((Ok
	          (Lam
	           (0 ()
	            (App
	             ((Match (cases ()) (default ((Lam (0 () (Var 0)))))) (Var 0))))))))
	       (default ()))
	      (App ((Lam (0 () (Ctor (Ok (Var 0))))) (Lam (0 () (Var 0)))))))))
	  (LetRec
	   (((3 (App ((Var 2) (Record ()))))
	     (3 (App ((Var 2) (Lam (0 () (Var 0)))))))
	    (App
	     ((App
	       ((Lam
	         (0 () (Lam (1 () (Update (old (Var 1)) (label k) (field (Var 0)))))))
	        (App
	         ((App
	           ((Lam
	             (0 ()
	              (Lam (1 () (Update (old (Var 1)) (label v) (field (Var 0)))))))
	            (Record ())))
	          (Var 1)))))
	      (Var 0)))))))

Evaluated:

	(Record ((k (Record ())) (v (Lam (0 () (Var 0))))))
